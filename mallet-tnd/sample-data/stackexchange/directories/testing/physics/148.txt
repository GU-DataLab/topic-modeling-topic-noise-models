 I can't believe nobody's mentioned Arnol'd's book "Mathematical Methods for Classical Mechanics" - it covers everything you ask for in the first paragraph quite elegantly (though sometimes somewhat tersely). 
