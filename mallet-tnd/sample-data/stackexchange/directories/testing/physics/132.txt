 In order to calculate the average speed you have to weight the time of the different parts of the trip, and not with the distance covered in the same parts! So the basic formula you hate to use is : $v_{avg}=S_{tot}/T_{tot}$ If your trip is divided into two parts - $S_1$ covered at speed $V_1$ and $S_2$ covered at speed $V_2$ - what you can't do is : $V_{avg}=\frac{V1\times S1+V2\times S2}{S_1+S_2}$ (i.e) actually what you did with yours: $\frac{1}2(40\ mph+60\ mph) = 50\ mph$, since in your example $S_1=S_2$. Whereas what you can do is : $V_{avg}=\frac{V1\times T1+V2\times T2}{T1+T2}$ That, given your input, can be written as $\frac{S_1+S_2}{S_1/V_1+S_2/V_2}$, which is indeed equal to $\frac{S_1+S_2}{T_1+T_2}$ 
